{% extends "base.html" %}
{% block title %}{{ title }}{% endblock %}

{% block content %}
<h3 class="mb-3">{{ title }}</h3>

<form method="post" class="mb-4">
  {% csrf_token %}
  {% if form.non_field_errors %}
    <div class="alert alert-danger">
      {% for e in form.non_field_errors %}<div>{{ e }}</div>{% endfor %}
    </div>
  {% endif %}

  <div class="row g-3">
    <div class="col-md-4">
      <label class="form-label">Username *</label>
      {{ form.username }}
      {% for err in form.username.errors %}<div class="text-danger small">{{ err }}</div>{% endfor %}
    </div>
    <div class="col-md-4">
      <label class="form-label">Email</label>
      {{ form.email }}
      {% for err in form.email.errors %}<div class="text-danger small">{{ err }}</div>{% endfor %}
    </div>
    <div class="col-md-4">
      <label class="form-label">Active</label>
      <div>{{ form.is_active }}</div>
      {% for err in form.is_active.errors %}<div class="text-danger small">{{ err }}</div>{% endfor %}
    </div>

    {% if form.password %}
      <div class="col-md-4">
        <label class="form-label">Initial password *</label>
        {{ form.password }}
        {% for err in form.password.errors %}<div class="text-danger small">{{ err }}</div>{% endfor %}
      </div>
    {% endif %}

    {% if form.new_password %}
      <div class="col-md-4">
        <label class="form-label">Reset password</label>
        {{ form.new_password }}
        {% for err in form.new_password.errors %}<div class="text-danger small">{{ err }}</div>{% endfor %}
      </div>
    {% endif %}

    <div class="col-md-4">
      <label class="form-label">Must change password at next login</label>
      <div>{{ form.must_change_password }}</div>
      {% for err in form.must_change_password.errors %}<div class="text-danger small">{{ err }}</div>{% endfor %}
    </div>

    <div class="col-12">
      <label class="form-label">Groups / Roles</label>
      <div class="border rounded p-2">
        {{ form.groups }}
      </div>
      <div class="form-text">Tick “admin” and/or “instructor”.</div>
      {% for err in form.groups.errors %}<div class="text-danger small">{{ err }}</div>{% endfor %}
    </div>
  </div>

  <div class="mt-3 d-flex gap-2">
    <a href="{% url 'admin_user_list' %}" class="btn btn-outline-secondary">Back</a>
    <button class="btn btn-primary" type="submit" name="save_continue" value="1">Save and continue editing</button>
    <button class="btn btn-success" type="submit" name="save_return" value="1">Save and return</button>
  </div>
</form>
{% endblock %}
